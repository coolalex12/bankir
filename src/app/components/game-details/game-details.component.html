<!-- {{ gameDetails$ | async | json }} -->
<div *ngIf="gameDetails$ | async as game">
  <div
    *ngFor="let gamer of game.gamersBuy"
    fxLayout="column"
    class="gamer-container"
  >
    <div fxLayout="row">
      <div
        fxLayout="column"
        fxFlex
        fxLayoutAlign="start start"
        fxLayoutGap="5px"
      >
        <span class="gamer-name">
          {{ gamer.user.name }}
        </span>
        <div fxLayout="row" fxLayoutGap="5px">
          <span *ngFor="let buy of gamer.buy">
            {{ buy.nominal }}*{{ buy.count }}
          </span>
        </div>

        <div fxLayout="column">
          <span>Всего закуп: {{ gamer.totalBuy | number }}</span>
          <div fxLayout="row" fxLayoutAlign="start center">
            <mat-label>На руках: {{ gamer.balance | number }}</mat-label>

            <button
              mat-icon-button
              color="primary"
              (click)="editBalanceBtnClick(gamer)"
            >
              <mat-icon>create</mat-icon>
            </button>
          </div>
          <div>Итог игры: {{ gamer.totalResult | number }}</div>
        </div>
      </div>

      <div fxLayout="row" fxLayoutGap="10px">
        <div fxLayout="column" fxLayoutGap="10px">
          <button
            mat-raised-button
            color="primary"
            class="buy-btn"
            (click)="addBuy(gamer.user, 200)"
          >
            +200
          </button>
          <button
            mat-raised-button
            color="primary"
            class="buy-btn"
            (click)="addBuy(gamer.user, 100)"
          >
            +100
          </button>
        </div>

        <div fxLayout="column" fxLayoutGap="10px">
          <button
            mat-raised-button
            color="primary"
            class="buy-btn"
            (click)="removeBuy(gamer.user, 200)"
          >
            -200
          </button>
          <button
            mat-raised-button
            color="primary"
            class="buy-btn"
            (click)="removeBuy(gamer.user, 100)"
          >
            -100
          </button>
        </div>
      </div>
    </div>
  </div>

  <app-game-results [game]="game"></app-game-results>
  <button
    mat-raised-button
    color="primary"
    class="buy-btn"
    (click)="calcTransactions()"
  >
    Рассчитать переводы
  </button>

  <div *ngIf="game.transactions">
    <div *ngFor="let transaction of game.transactions">
      {{ transaction.sender.name }} {{ transaction.value }}
      {{ transaction.recipient.name }}
    </div>
  </div>
</div>
